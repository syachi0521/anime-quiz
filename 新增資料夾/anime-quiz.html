<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>腦洞星期五 Ver. 動漫 2</title>
  <style>
    * { box-sizing:border-box; margin:0; padding:0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:#111;
      color:#fff;
      padding:20px;
      min-height:100vh;
    }
    h1 { text-align:center; margin-bottom:20px; }

    .board {
      max-width: 1200px;
      margin: 0 auto;
      display:grid;
      grid-template-columns:repeat(3,1fr);
      grid-template-rows:repeat(2,1fr);
      gap:16px;
    }
    .category {
      border-radius:12px;
      padding:16px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      align-items:center;
      min-height:180px;
    }
    .category-title { font-size:22px; margin-bottom:6px; }
    .category-sub { opacity:.7; margin-bottom:10px; }
    .points { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; }
    .points button {
      background:#222;
      border:none;
      color:#fff;
      padding:8px 12px;
      border-radius:6px;
      cursor:pointer;
      font-size:16px;
      transition:transform .1s ease, background .2s;
    }
    .points button:hover { background:#444; transform:translateY(-2px); }
    .points button.used { background:#555; opacity:.5; cursor:default; }

    .cat-A{background:#2ecc71;}
    .cat-B{background:#f1c40f;}
    .cat-C{background:#e84393;}
    .cat-D{background:#3498db;}
    .cat-E{background:#9b59b6;}
    .cat-F{background:#e67e22;}

    /* Modal */
    .overlay{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.75);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .overlay.show{display:flex;}

    .modal{
      width:min(900px,95vw);
      background:#0b1724;
      border-radius:12px;
      padding:18px 22px 22px;
      box-shadow:0 0 35px rgba(0,0,0,.8);
      position:relative;
    }
    .modal-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:16px;
    }
    .modal-title{font-size:20px;}
    .close-btn{
      border:none;
      background:transparent;
      color:#fff;
      font-size:26px;
      cursor:pointer;
    }
    .timer{
      padding:4px 10px;
      border-radius:999px;
      background:#1abc9c;
      font-weight:bold;
      font-size:16px;
      margin-right:8px;
    }

    .modal-body{
      background:#09121e;
      border-radius:10px;
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
      justify-content:center;
      min-height:230px;
      text-align:center;
      margin-bottom:14px;
    }
    .question-text{
      font-size:18px;
      line-height:1.6;
    }
    .question-image{
      max-width:100%;
      max-height:260px;
      border-radius:8px;
      object-fit:contain;
    }
    .question-video{
      width:100%;
      max-height:260px;
      border-radius:8px;
    }

    .controls{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-bottom:10px;
    }
    .controls button,.answer-toggle{
      border:none;
      border-radius:6px;
      padding:8px 14px;
      font-size:14px;
      cursor:pointer;
      color:#fff;
    }
    .btn-start{background:#27ae60;}
    .btn-pause{background:#e67e22;}
    .btn-reset{background:#c0392b;}
    .answer-toggle{background:#2980b9;}

    .answer-box{
      margin-top:6px;
      padding:10px 12px;
      border-radius:8px;
      background:#02060d;
      display:none;
      min-height:36px;
      text-align:left;
      font-size:16px;
      line-height:1.5;
    }

    @media (max-width:800px){
      .board{grid-template-columns:1fr;}
      .category{min-height:auto;}
    }
  </style>
</head>
<body>
  <h1>腦洞星期五 Ver. 動漫 2</h1>

  <!-- 六大類別 -->
  <div class="board" id="board"></div>

  <!-- 題目彈窗 -->
  <div class="overlay" id="overlay">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title" id="modalTitle"></div>
        <div style="display:flex; align-items:center;">
          <div class="timer" id="timer">00:30</div>
          <button class="close-btn" id="closeBtn">&times;</button>
        </div>
      </div>

      <div class="modal-body" id="modalBody"></div>

      <div class="controls">
        <button class="btn-start" id="startBtn">開始</button>
        <button class="btn-pause" id="pauseBtn">暫停</button>
        <button class="btn-reset" id="resetBtn">重設</button>
        <button class="answer-toggle" id="answerBtn">顯示答案</button>
      </div>

      <div class="answer-box" id="answerBox"></div>
    </div>
  </div>

  <script>
    /* ===========================
       題庫：在這裡改題目 / 圖片 / 影片
       =========================== */

    const QUESTION_BANK = [
      // 圖片題
      {
        categoryId: "image",
        categoryName: "圖片題",
        categoryLabel: "A",
        colorClass: "cat-A",
        questions: [
          {
            score: 200,
            title: "圖片題 - 200 分",
            text: "這是哪一部動畫？",
            imageUrl: "1.jpg", // 改成你的圖片檔或網址
            videoUrl: "",              // 若不要影片就留空
            answer: "這裡填入答案",
            time: 30
          },
          {
            score: 400,
            title: "圖片題 - 400 分",
            text: "請說出角色名稱。",
            imageUrl: "img/demo2.jpg",
            videoUrl: "",
            answer: "角色名稱",
            time: 30
          },
          {
            score: 600,
            title: "圖片題 - 600 分",
            text: "請說出這個場景出自哪一集或哪一章。",
            imageUrl: "",
            videoUrl: "https://www.youtube.com/embed/你的ID", // 也可以放 YouTube
            answer: "集數 / 章節名稱",
            time: 40
          },
          { score: 800, title: "圖片題 - 800 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 1000,title: "圖片題 - 1000 分",text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 50 }
        ]
      },

      // 一般題
      {
        categoryId: "general",
        categoryName: "一般題",
        categoryLabel: "B",
        colorClass: "cat-B",
        questions: [
          {
            score: 200,
            title: "一般題 - 200 分",
            text: "請說出路飛所屬的海賊團名稱。",
            imageUrl: "",
            videoUrl: "",
            answer: "草帽海賊團",
            time: 30
          },
          { score: 400, title: "一般題 - 400 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 30 },
          { score: 600, title: "一般題 - 600 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 800, title: "一般題 - 800 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 1000,title: "一般題 - 1000 分",text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 50 }
        ]
      },

      // 他說了啥
      {
        categoryId: "quote",
        categoryName: "他說了啥",
        categoryLabel: "C",
        colorClass: "cat-C",
        questions: [
          {
            score: 200,
            title: "他說了啥 - 200 分",
            text: "「我要成為海賊王！」這句台詞出自誰？",
            imageUrl: "",
            videoUrl: "",
            answer: "蒙其・D・魯夫",
            time: 30
          },
          { score: 400, title: "他說了啥 - 400 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 30 },
          { score: 600, title: "他說了啥 - 600 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 800, title: "他說了啥 - 800 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 1000,title: "他說了啥 - 1000 分",text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 50 }
        ]
      },

      // 音樂題（這邊示範用影片欄位放 OP MV 或純音樂）
      {
        categoryId: "music",
        categoryName: "音樂題",
        categoryLabel: "D",
        colorClass: "cat-D",
        questions: [
          {
            score: 200,
            title: "音樂題 - 200 分",
            text: "請聽音樂，說出動畫名稱。",
            imageUrl: "",
            videoUrl: "music/op1.mp4", // 也可以放 YouTube embed
            answer: "在這裡填答案",
            time: 30
          },
          { score: 400, title: "音樂題 - 400 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 30 },
          { score: 600, title: "音樂題 - 600 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 800, title: "音樂題 - 800 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 1000,title: "音樂題 - 1000 分",text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 50 }
        ]
      },

      // 神秘
      {
        categoryId: "mystery",
        categoryName: "神秘",
        categoryLabel: "E",
        colorClass: "cat-E",
        questions: [
          { score: 200, title: "神秘 - 200 分", text: "神秘問題示範。", imageUrl: "", videoUrl: "", answer: "神秘答案", time: 30 },
          { score: 400, title: "神秘 - 400 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 30 },
          { score: 600, title: "神秘 - 600 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 800, title: "神秘 - 800 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 1000,title: "神秘 - 1000 分",text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 50 }
        ]
      },

      // 加分題
      {
        categoryId: "bonus",
        categoryName: "加分題",
        categoryLabel: "F",
        colorClass: "cat-F",
        questions: [
          { score: 200, title: "加分題 - 200 分", text: "加分題示範。", imageUrl: "", videoUrl: "", answer: "加分答案", time: 30 },
          { score: 400, title: "加分題 - 400 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 30 },
          { score: 600, title: "加分題 - 600 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 800, title: "加分題 - 800 分", text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 40 },
          { score: 1000,title: "加分題 - 1000 分",text: "自行填題目", imageUrl: "", videoUrl: "", answer: "自行填答案", time: 50 }
        ]
      }
    ];

    /* ===========================
       動態生成主畫面按鈕
       =========================== */
    const board = document.getElementById("board");
    const overlay = document.getElementById("overlay");
    const modalTitle = document.getElementById("modalTitle");
    const modalBody = document.getElementById("modalBody");
    const timerEl = document.getElementById("timer");
    const answerBox = document.getElementById("answerBox");
    const closeBtn = document.getElementById("closeBtn");
    const startBtn = document.getElementById("startBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const resetBtn = document.getElementById("resetBtn");
    const answerBtn = document.getElementById("answerBtn");

    let currentQuestion = null;
    let countdown = 30;
    let timerId = null;

    function initBoard() {
      QUESTION_BANK.forEach(cat => {
        const catDiv = document.createElement("div");
        catDiv.className = `category ${cat.colorClass}`;

        catDiv.innerHTML = `
          <div>
            <div class="category-title">${cat.categoryName}</div>
            <div class="category-sub">${cat.categoryLabel}</div>
          </div>
          <div class="points" data-category="${cat.categoryId}"></div>
        `;

        const pointsDiv = catDiv.querySelector(".points");

        [200,400,600,800,1000].forEach(score => {
          const btn = document.createElement("button");
          btn.textContent = score;
          btn.dataset.score = score;
          btn.addEventListener("click", () => onScoreClick(cat.categoryId, score, btn));
          pointsDiv.appendChild(btn);
        });

        board.appendChild(catDiv);
      });
    }

    function findQuestion(categoryId, score) {
      const cat = QUESTION_BANK.find(c => c.categoryId === categoryId);
      if (!cat) return null;
      return cat.questions.find(q => q.score === score) || null;
    }

    function onScoreClick(categoryId, score, btn) {
      const q = findQuestion(categoryId, Number(score));
      if (!q) {
        alert("這題還沒設定喔！");
        return;
      }
      currentQuestion = q;
      btn.classList.add("used");
      openModal();
    }

    /* ===========================
       題目彈窗 & 顯示媒體
       =========================== */
    function openModal() {
      clearTimer();

      modalTitle.textContent = currentQuestion.title || "";
      countdown = currentQuestion.time || 30;
      renderTimer();

      modalBody.innerHTML = "";

      // 圖片
      if (currentQuestion.imageUrl) {
        const img = document.createElement("img");
        img.src = currentQuestion.imageUrl;
        img.alt = currentQuestion.text || "";
        img.className = "question-image";
        modalBody.appendChild(img);
      }

      // 影片（YouTube embed 或 mp4）
      if (currentQuestion.videoUrl) {
        const isYouTube = currentQuestion.videoUrl.includes("youtube.com") || currentQuestion.videoUrl.includes("youtu.be");
        if (isYouTube) {
          const iframe = document.createElement("iframe");
          iframe.src = currentQuestion.videoUrl;
          iframe.className = "question-video";
          iframe.frameBorder = "0";
          iframe.allow =
            "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
          iframe.allowFullscreen = true;
          modalBody.appendChild(iframe);
        } else {
          const video = document.createElement("video");
          video.src = currentQuestion.videoUrl;
          video.className = "question-video";
          video.controls = true;
          modalBody.appendChild(video);
        }
      }

      // 文字題目
      if (currentQuestion.text) {
        const textDiv = document.createElement("div");
        textDiv.className = "question-text";
        textDiv.textContent = currentQuestion.text;
        modalBody.appendChild(textDiv);
      }

      answerBox.style.display = "none";
      answerBox.textContent = "";
      answerBtn.textContent = "顯示答案";

      overlay.classList.add("show");
    }

    function closeModal() {
      clearTimer();
      overlay.classList.remove("show");
      modalBody.innerHTML = "";
    }

    /* ===========================
       計時器
       =========================== */
    function renderTimer() {
      const m = String(Math.floor(countdown / 60)).padStart(2,"0");
      const s = String(countdown % 60).padStart(2,"0");
      timerEl.textContent = `${m}:${s}`;
    }

    function startTimer() {
      if (timerId || !currentQuestion) return;
      timerId = setInterval(() => {
        countdown--;
        if (countdown <= 0) {
          countdown = 0;
          renderTimer();
          clearTimer();
        } else {
          renderTimer();
        }
      }, 1000);
    }

    function clearTimer() {
      if (timerId) {
        clearInterval(timerId);
        timerId = null;
      }
    }

    function resetTimer() {
      if (!currentQuestion) return;
      clearTimer();
      countdown = currentQuestion.time || 30;
      renderTimer();
    }

    /* ===========================
       顯示 / 隱藏答案
       =========================== */
    function toggleAnswer() {
      if (!currentQuestion) return;
      if (answerBox.style.display === "none" || answerBox.style.display === "") {
        answerBox.style.display = "block";
        answerBox.textContent = currentQuestion.answer || "";
        answerBtn.textContent = "隱藏答案";
      } else {
        answerBox.style.display = "none";
        answerBtn.textContent = "顯示答案";
      }
    }

    /* ===========================
       事件綁定
       =========================== */
    closeBtn.addEventListener("click", closeModal);
    overlay.addEventListener("click", e => {
      if (e.target === overlay) closeModal();
    });
    startBtn.addEventListener("click", startTimer);
    pauseBtn.addEventListener("click", clearTimer);
    resetBtn.addEventListener("click", resetTimer);
    answerBtn.addEventListener("click", toggleAnswer);

    initBoard();   // 產生整個主畫面
    renderTimer(); // 初始化時間
  </script>
</body>
</html>
